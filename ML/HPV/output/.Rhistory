ex,
by = c("seq2" = "sequence")) |>
drop_na(DNAzyme) |>
View()
# Check the type of 'annotated'
print(class(annotated))
# full merged data: for later exploration and prediction
write_csv(mergedData, "mergedData.csv")
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
View()
# Check the type of 'annotated'
print(class(annotated))
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
View()
# subset with experimental data: for training and evaluation
write_csv(annotated, "mergedData_annotated.csv")
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
View()
# subset with experimental data: for training and evaluation
write_csv(annotated, "mergedData_annotated.csv")
tryCatch({
# Check if it's a data frame first
if (is.data.frame(annotated)) {
# Try writing with write.csv as an alternative
write.csv(annotated, "mergedData_annotated.csv", row.names = FALSE)
print("File successfully written using write.csv")
} else {
# If not a data frame, try converting it first
annotated_df <- as.data.frame(annotated)
write.csv(annotated_df, "mergedData_annotated.csv", row.names = FALSE)
print("File written after converting to data frame")
}
}, error = function(e) {
print(paste("Error occurred:", e$message))
# Additional debugging information
print("Directory writable?")
print(file.access(getwd(), mode = 2) == 0)
print("Current working directory:")
print(getwd())
})
# Check if file was created
if (file.exists("mergedData_annotated.csv")) {
print("File exists after writing")
print(paste("File size:", file.size("mergedData_annotated.csv"), "bytes"))
} else {
print("File was not created")
}
# subset with experimental data: for training and evaluation
write_csv(annotated, "mergedData_annotated.csv")
View()
try({
write_csv(annotated, "mergedData_annotated.csv")
})
try({
write.csv(annotated, "mergedData_annotated.csv", row.names = FALSE)
})
# subset with experimental data: for training and evaluation
write_csv(annotated, "mergedData_annotated.csv")
try({
write_csv(annotated, "mergedData_annotated.csv")
})
try({
write.csv(annotated, "mergedData_annotated.csv", row.names = FALSE)
})
# subset with experimental data: for training and evaluation
write_csv(annotated, "mergedData_annotated.csv")
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
is.data.frame(annotated)
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) %>%
drop_na(DNAzyme) |>
is.data.frame(annotated)
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) %>%
drop_na(DNAzyme) |>
View()
# subset with experimental data: for training and evaluation
write_csv(annotated, "mergedData_annotated.csv")
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
View()
print(dim(annotated)
annotated <-
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
View()
print(dim(annotated))
# subset with experimental data: for training and evaluation
write.csv(annotated, "mergedData_annotated.csv", row.names = FALSE)
# subset with experimental data: for training and evaluation
write.csv(annotated, "mergedData_annotated.csv")
# full merged data: for later exploration and prediction
write_csv(mergedData, "mergedData.csv")
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
View()
print(dim(annotated))
# subset with experimental data: for training and evaluation
write.csv(annotated, "mergedData_annotated.csv")
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
View()
print(dim(annotated))
# 1. First check if mergedData exists and has data
print("Checking mergedData:")
print(dim(mergedData))
print(head(mergedData$seq2))
# 2. Check if ex exists and has data
print("Checking ex:")
print(dim(ex))
print(head(ex$seq))
# 3. Try the join without the drop_na first
annotated <- left_join(mergedData,
ex,
by = c("seq2" = "seq"))
print("After join:")
print(dim(annotated))
# 4. Then add the drop_na step separately
annotated <- annotated %>% drop_na(DNAzyme)
print("Do data frames exist?")
print(exists("mergedData"))
print(exists("ex"))
# Check column names
print("Column names in mergedData:")
print(colnames(mergedData))
print("Column names in ex:")
print(colnames(ex))
print("After drop_na:")
print(dim(annotated))
# subset with experimental data: for training and evaluation
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
print(dim(annotated))
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
annotated <- as.data.frame(annotated)
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
annotated <- as.data.frame(annotated)
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
annotated <- as.data.frame(annotated)
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
annotated <- as.data.frame(annotated)
# merge all data sets
mergedData <-
full_join(out[[1]], out[[2]], by =c("id2_1"="id2_2",
"seq2_1"="seq2_2",
"solIdx_1"="solIdx_2")) |>
full_join(out[[3]], by =c("id2_1"="id2_3",
"seq2_1"="seq2_3",
"solIdx_1"="solIdx_3")) |>
rename( id2 = id2_1, seq2 = seq2_1, solIdx = solIdx_1) |>
# NA handling
replace_na(
# list(
# unlist(
c(
set_names(naDefaults, ~str_c(.,"_1")),
set_names(naDefaults, ~str_c(.,"_2")),
set_names(naDefaults, ~str_c(.,"_3"))
)
# )
# )
)
# full merged data: for later exploration and prediction
write_csv(mergedData, "mergedData.csv")
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
View()
# subset with experimental data: for training and evaluation
write_csv(annotated, "mergedData_annotated.csv")
# subset with experimental data: for training and evaluation
write_csv(annotated, file = "mergedData_annotated.csv")
for (i in 1:3) {
out[[i]] <-
read_delim( str_c("1_output",i,".csv"),
delim=";") |>
group_by(id2) |>
mutate(solIdx = row_number()) |>
ungroup() |>
# TODO: add additional derived data columns
#....
# number of seeds
mutate(
seedNumber = str_count(seedE, ":")+1,
seedEbest = str_extract(seedE,"^[^:]+") %>% as.numeric()
) |>
# final step: add suffiy to column names
rename_with( everything(), .fn = str_c, "_", i)
}
ex <-
read_csv("../Article/data.csv")|>
mutate( seq = str_to_upper(Sequence) |> str_replace_all("T", "U")) |>
mutate( seqRC = str_to_upper(SequenceRC) |> str_replace_all("T", "U"))
out <- list()
# loading each individual output file
for (i in 1:3) {
out[[i]] <-
read_delim( str_c("1_output",i,".csv"),
delim=",") |>
group_by(id2) |>
mutate(solIdx = row_number()) |>
ungroup() |>
# TODO: add additional derived data columns
#....
# number of seeds
mutate(
seedNumber = str_count(seedE, ":")+1,
seedEbest = str_extract(seedE,"^[^:]+") %>% as.numeric()
) |>
# final step: add suffiy to column names
rename_with( everything(), .fn = str_c, "_", i)
}
View(out[[3]])
# prepare NA handling
naDefaults <-
list(
# derived features
seedEbest=0,
seedNumber=0,
# # strings and positions: NA
# id2,seq2,
# subseqDB,hybridDB,
# seedStart1,seedEnd1,seedStart2,seedEnd2,
# energies, probabilities, partition functions: default = 0
E=0,
Etotal=0,
Pu1=0,
Pu2=0,
E_hybrid=0,
E_norm=0,
E_hybridNorm=0,
Eall=0,
Eall1=0,
Eall2=0,
Zall=0,
Zall1=0,
Zall2=0,
EallTotal=0,
P_E=0,
# default == infinity
ED1=999999,
ED2=999999,
# multi-value elements: string versions
seedE="0",
seedPu1="0",
seedPu2="0",
seedED1="999999",
seedED2="999999"
)
# merge all data sets
mergedData <-
full_join(out[[1]], out[[2]], by =c("id2_1"="id2_2",
"seq2_1"="seq2_2",
"solIdx_1"="solIdx_2")) |>
full_join(out[[3]], by =c("id2_1"="id2_3",
"seq2_1"="seq2_3",
"solIdx_1"="solIdx_3")) |>
rename( id2 = id2_1, seq2 = seq2_1, solIdx = solIdx_1) |>
# NA handling
replace_na(
# list(
# unlist(
c(
set_names(naDefaults, ~str_c(.,"_1")),
set_names(naDefaults, ~str_c(.,"_2")),
set_names(naDefaults, ~str_c(.,"_3"))
)
# )
# )
)
# full merged data: for later exploration and prediction
write_csv(mergedData, "mergedData.csv")
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
View()
# subset with experimental data: for training and evaluation
write_csv(annotated, file = "mergedData_annotated.csv")
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
View()
annotated <- as.data.frame(annotated)
# subset with experimental data: for training and evaluation
write_csv(annotated, file = "mergedData_annotated.csv")
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
View()
if (!is.data.frame(annotated)) stop("`annotated` is not a valid data frame.")
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
View()
str(mergedData)  # Inspect structure of mergedData
str(ex)
if (!is.data.frame(annotated)) stop("`annotated` is not a valid data frame.")
library(tibble)
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
View()
annotated <- as.data.frame(annotated)
# subset with experimental data: for training and evaluation
write_csv(annotated, file = "mergedData_annotated.csv")
annotated <- as.data.frame(annotated)
print(annotated)
# full merged data: for later exploration and prediction
write_csv(mergedData, "mergedData.csv")
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
View()
# subset with experimental data: for training and evaluation
write_csv(annotated, file = "mergedData_annotated.csv")
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
View()
# subset with experimental data: for training and evaluation
write.csv(annotated, file = "mergedData_annotated.csv")
# full merged data: for later exploration and prediction
write_csv(mergedData, "mergedData.csv")
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
View()
# subset with experimental data: for training and evaluation
write.csv(annotated, file = "mergedData_annotated.csv")
# subset with experimental data: for training and evaluation
write.csv(annotated, file = "mergedData_annotated.csv, row.names=TRUE")
# subset with experimental data: for training and evaluation
write.csv(annotated, file = "mergedData_annotated.csv, row.names=TRUE)"
# subset with experimental data: for training and evaluation
write.csv(annotated, file = "mergedData_annotated.csv, row.names=TRUE)"
# subset with experimental data: for training and evaluation
write.csv(annotated, file = "mergedData_annotated.csv, row.names=TRUE)
# subset with experimental data: for training and evaluation
write.csv(annotated, "mergedData_annotated.csv", row.names=TRUE)
# subset with experimental data: for training and evaluation
write.csv(annotated, "mergedData_annotated.csv")
# merge all data sets
mergedData <-
full_join(out[[1]], out[[2]], by =c("id2_1"="id2_2",
"seq2_1"="seq2_2",
"solIdx_1"="solIdx_2")) |>
full_join(out[[3]], by =c("id2_1"="id2_3",
"seq2_1"="seq2_3",
"solIdx_1"="solIdx_3")) |>
rename( id2 = id2_1, seq2 = seq2_1, solIdx = solIdx_1) |>
# NA handling
replace_na(
# list(
# unlist(
c(
set_names(naDefaults, ~str_c(.,"_1")),
set_names(naDefaults, ~str_c(.,"_2")),
set_names(naDefaults, ~str_c(.,"_3"))
)
# )
# )
)
# full merged data: for later exploration and prediction
write_csv(mergedData, "mergedData.csv")
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
View()
# subset with experimental data: for training and evaluation
write.csv(annotated, "mergedData_annotated.csv")
# merge all data sets
mergedData <-
full_join(out[[1]], out[[2]], by =c("id2_1"="id2_2",
"seq2_1"="seq2_2",
"solIdx_1"="solIdx_2")) |>
full_join(out[[3]], by =c("id2_1"="id2_3",
"seq2_1"="seq2_3",
"solIdx_1"="solIdx_3")) |>
rename( id2 = id2_1, seq2 = seq2_1, solIdx = solIdx_1) |>
# NA handling
replace_na(
# list(
# unlist(
c(
set_names(naDefaults, ~str_c(.,"_1")),
set_names(naDefaults, ~str_c(.,"_2")),
set_names(naDefaults, ~str_c(.,"_3"))
)
# )
# )
)
# full merged data: for later exploration and prediction
write_csv(mergedData, "mergedData.csv")
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
View()
# subset with experimental data: for training and evaluation
write.csv(annotated, "mergedData_annotated.csv")
# full merged data: for later exploration and prediction
write_csv(mergedData, "mergedData.csv")
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
View()
head(annotated)
drop_na(DNAzyme) |>
View()
head(annotated)
# subset with experimental data: for training and evaluation
write.csv(annotated, "mergedData_annotated.csv", row.names = FALSE)
# full merged data: for later exploration and prediction
write_csv(mergedData, "mergedData.csv")
annotated <-
left_join( mergedData,
ex,
by = c("seq2" = "seq")) |>
drop_na(DNAzyme) |>
View()
annotated <- drop_na(annotated, DNAzyme)
annotated <- drop_na(annotated, DNAzyme)
# subset with experimental data: for training and evaluation
write.csv(annotated, "mergedData_annotated.csv")
# Perform the join
annotated <- left_join(mergedData, ex, by = c("seq2" = "seq"))
# Inspect before drop_na()
head(annotated)
# If data exists, apply drop_na
if(nrow(annotated) > 0) {
annotated <- drop_na(annotated, DNAzyme)
} else {
print("No data to process after join!")
}
# Check final result
head(annotated)
head(annotated)
write.csv(annotated, "mergedData_annotated.csv")
